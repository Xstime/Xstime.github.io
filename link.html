<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”±æ­¤å‡ºå‘ğŸ›«</title>
    <link rel="icon" type="image/png" href="touxiang.png">   
    <link rel="stylesheet" href="styles/variables.css">
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/link.css">
</head>
<body>

    <a href="index.html" class="fixed-button back-button">â†</a>
    <button class="fixed-button theme-toggle" onclick="toggleTheme()">ğŸŒ—</button>
    <a href="http://192.168.5.1/cgi-bin/luci/" target="_blank" class="fixed-button router-button">ğŸ›œ</a>

    <!-- ä¸»å†…å®¹å®¹å™¨ - Main Content Container -->
    <div class="main-container">
        
        <!-- å†…å®¹å¡ç‰‡1ï¼šç”±æ­¤å‡ºå‘ - Content Card 1: Launch Pad -->
        <div id="content-home" class="content-card active">
            <div class="container">
                <h1 class="main-title">ç”±æ­¤å‡ºå‘</h1>
                <div id="link-list"></div>
            </div>
        </div>

        <!-- å†…å®¹å¡ç‰‡2ï¼šæœç´¢å‘ç° - Content Card 2: Search & Discovery -->
        <div id="content-search" class="content-card">
            <div class="container">
                <h1>å­¦æœ¯èµ„æº</h1>
                <div class="search-content">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="æœç´¢å­¦æœ¯æ•°æ®åº“ã€è®ºæ–‡æˆ–å·¥å…·..." class="search-input">
                        <button class="search-button">ğŸ”</button>
                    </div>
                    <div class="search-suggestions">
                        <h3>å¸¸ç”¨å­¦æœ¯æ ‡ç­¾</h3>
                        <div class="suggestion-tags">
                            <span class="tag">è®ºæ–‡æ£€ç´¢</span>
                            <span class="tag">å­¦æœ¯æ•°æ®åº“</span>
                            <span class="tag">æ–‡çŒ®ç®¡ç†</span>
                            <span class="tag">å­¦æœ¯å†™ä½œ</span>
                            <span class="tag">å¼€æºæœŸåˆŠ</span>
                        </div>
                    </div>
                    <div class="quick-access">
                        <h3>å¿«é€Ÿè®¿é—®</h3>
                        <div class="quick-links">
                            <a href="https://scholar.google.com" target="_blank" class="quick-link">
                                <img src="icon/scholar.google.com.png" alt="Google Scholar" class="quick-icon" 
                                     onerror="this.src='https://www.google.com/s2/favicons?domain=scholar.google.com&sz=32'">
                                <span>Google Scholar</span>
                            </a>
                            <a href="https://www.cnki.net" target="_blank" class="quick-link">
                                <img src="icon/www.cnki.net.png" alt="ä¸­å›½çŸ¥ç½‘" class="quick-icon"
                                    onerror="this.src='https://www.google.com/s2/favicons?domain=www.cnki.net&sz=32'">
                                <span>ä¸­å›½çŸ¥ç½‘</span>
                            </a>
                            <a href="https://www.webofscience.com" target="_blank" class="quick-link">
                                <img src="icon/www.webofscience.com.png" alt="Web of Science" class="quick-icon" 
                                     onerror="this.src='https://www.google.com/s2/favicons?domain=www.webofscience.com&sz=32'">
                                <span>Web of Science</span>
                            </a>
                            <a href="https://www.wanfangdata.com.cn" target="_blank" class="quick-link">
                                <img src="icon/www.wanfangdata.com.cn.png" alt="ä¸‡æ–¹æ•°æ®" class="quick-icon"
                                     onerror="this.src='https://www.google.com/s2/favicons?domain=www.wanfangdata.com.cn&sz=32'">
                                <span>ä¸‡æ–¹æ•°æ®</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å†…å®¹å¡ç‰‡3ï¼šç³»ç»Ÿè®¾ç½® - Content Card 3: System Settings -->
        <div id="content-settings" class="content-card">
            <div class="container">
                <h1>ç³»ç»Ÿè®¾ç½®</h1>
                <div class="settings-content">
                    <div class="settings-section">
                        <h3>å¤–è§‚è®¾ç½®</h3>
                        <div class="setting-item">
                            <label>ä¸»é¢˜æ¨¡å¼</label>
                            <div class="theme-selector">
                                <button class="theme-option active" data-theme="auto">ğŸŒ— è‡ªåŠ¨</button>
                                <button class="theme-option" data-theme="light">â˜€ï¸ æ˜äº®</button>
                                <button class="theme-option" data-theme="dark">ğŸŒ™ æ·±è‰²</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="dock">
        <div class="dock-bubble"></div>
        <a href="#" class="dock-item active" data-content="home">
            <span class="dock-icon">ğŸ </span>
            <span class="dock-label">ä¸»é¡µ</span>
        </a>
        <a href="#" class="dock-item" data-content="search">
            <span class="dock-icon">ğŸ‘¨â€ğŸ“</span>
            <span class="dock-label">å­¦æœ¯</span>
        </a>
        <a href="#" class="dock-item" data-content="settings">
            <span class="dock-icon">âš™ï¸</span>
            <span class="dock-label">è®¾ç½®</span>
        </a>
    </div>

    <script>
        const linkList = document.getElementById('link-list');
        const turbulence = document.getElementById('turbulence');
        let frame = 0;
        let rad = Math.PI / 180;

        function animateTurbulence() {
            const bfx = 0.01 + 0.005 * Math.cos(frame * rad);
            const bfy = 0.01 + 0.005 * Math.sin(frame * rad);
            turbulence.setAttribute('baseFrequency', `${bfx} ${bfy}`);
            frame += 0.5;
            requestAnimationFrame(animateTurbulence);
        }

        // ä» links.json æ–‡ä»¶åŠ è½½é“¾æ¥
        async function loadLinks() {
            try {
                const response = await fetch('./links.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const links = await response.json();
                renderLinks(links);
            } catch (error) {
                console.error('æ— æ³•åŠ è½½ links.json æ–‡ä»¶:', error);
                linkList.innerHTML = '<p style="text-align:center; color: #ff453a;">åŠ è½½é“¾æ¥å¤±è´¥ã€‚è¯·æ£€æŸ¥ links.json æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®ã€‚</p>';
            }
        }

        // æ¸²æŸ“é“¾æ¥åˆ°é¡µé¢
        function renderLinks(links = []) {
            linkList.innerHTML = '';
            if (links.length === 0) {
                linkList.innerHTML = '<p style="text-align:center;">æ²¡æœ‰æ‰¾åˆ°é“¾æ¥ã€‚</p>';
                return;
            }
            links.forEach(link => {
                const linkItem = document.createElement('a');
                linkItem.href = link.url;
                linkItem.target = '_blank';
                linkItem.className = 'link-item';

                // Create and add the favicon
                const favicon = document.createElement('img');
                favicon.className = 'favicon';
                try {
                    const domain = new URL(link.url).hostname;
                    // ä¼˜å…ˆä»æœ¬åœ° /icon æ–‡ä»¶å¤¹åŠ è½½å›¾æ ‡
                    favicon.src = `icon/${domain}.png`;

                    // å¦‚æœæœ¬åœ°å›¾æ ‡åŠ è½½å¤±è´¥ï¼Œåˆ™å›é€€åˆ°ä» Google æœåŠ¡è·å–
                    favicon.onerror = () => {
                        favicon.src = `https://www.google.com/s2/favicons?domain=${domain}&sz=32`;
                        // é˜²æ­¢å›é€€ä¹Ÿå¤±è´¥æ—¶è¿›å…¥æ­»å¾ªç¯
                        favicon.onerror = null; 
                    };
                } catch (e) {
                    // å¦‚æœ URL æ— æ•ˆï¼Œåˆ™éšè—å›¾æ ‡
                    favicon.style.display = 'none';
                }
                linkItem.appendChild(favicon);
                
                const nameSpan = document.createElement('span');
                nameSpan.textContent = link.name;
                linkItem.appendChild(nameSpan);

                linkList.appendChild(linkItem);
            });
        }

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
        }

        // æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½ - Tab Switching Functionality
        function switchContent(targetContent) {
            // è·å–èœå•é¡¹é¡ºåºæ˜ å°„
            const menuOrder = {
                'home': 0,
                'search': 1,
                'settings': 2
            };
            
            // è·å–å½“å‰æ´»åŠ¨çš„èœå•é¡¹å’Œå†…å®¹å¡ç‰‡
            const currentMenuItem = document.querySelector('.dock-item.active');
            const currentContent = currentMenuItem ? currentMenuItem.getAttribute('data-content') : 'home';
            const currentCard = document.getElementById(`content-${currentContent}`);
            
            // å¦‚æœç›®æ ‡å†…å®¹å’Œå½“å‰å†…å®¹ç›¸åŒï¼Œä¸éœ€è¦åˆ‡æ¢
            if (currentContent === targetContent) return;
            
            // æ¯”è¾ƒä½ç½®å†³å®šåŠ¨ç”»æ–¹å‘
            const currentIndex = menuOrder[currentContent];
            const targetIndex = menuOrder[targetContent];
            const isMovingRight = targetIndex > currentIndex;
            
            // ä¸ºå½“å‰å¡ç‰‡æ·»åŠ æ»‘å‡ºåŠ¨ç”»
            if (currentCard) {
                if (isMovingRight) {
                    currentCard.classList.add('exit-left');
                } else {
                    currentCard.classList.add('exit-right');
                }
            }
            
            // ç§»é™¤èœå•é¡¹çš„æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.dock-item').forEach(item => {
                item.classList.remove('active');
            });

            // æ¿€æ´»ç›®æ ‡å†…å®¹å’Œèœå•é¡¹
            const targetCard = document.getElementById(`content-${targetContent}`);
            const targetMenuItem = document.querySelector(`.dock-item[data-content="${targetContent}"]`);
            
            if (targetCard && targetMenuItem) {
                // å»¶è¿Ÿæ˜¾ç¤ºæ–°å†…å®¹ï¼Œè®©æ»‘å‡ºåŠ¨ç”»å…ˆå¼€å§‹
                setTimeout(() => {
                    // æ¸…ç†æ‰€æœ‰å†…å®¹å¡ç‰‡çš„çŠ¶æ€
                    document.querySelectorAll('.content-card').forEach(card => {
                        card.classList.remove('active', 'prev', 'next', 'from-right', 'from-left', 'exit-left', 'exit-right');
                    });
                    
                    // æ¿€æ´»ç›®æ ‡å¡ç‰‡
                    targetCard.classList.add('active');
                    
                    // æ ¹æ®æ–¹å‘æ·»åŠ æ»‘å…¥åŠ¨ç”»
                    if (isMovingRight) {
                        targetCard.classList.add('from-right');
                    } else {
                        targetCard.classList.add('from-left');
                    }
                    
                    // åŠ¨ç”»å®Œæˆåæ¸…ç†æ–¹å‘ç±»
                    setTimeout(() => {
                        targetCard.classList.remove('from-right', 'from-left');
                    }, 500);
                }, 50);
                
                targetMenuItem.classList.add('active');
                
                // æ›´æ–°æ°”æ³¡ä½ç½®
                moveBubbleTo(targetMenuItem);
            }
        }

        // åˆå§‹åŠ è½½
        loadLinks();
        
        // Liquid Dock Logic with Enhanced Effects
        const dock = document.querySelector('.dock');
        const bubble = document.querySelector('.dock-bubble');
        const dockItems = document.querySelectorAll('.dock-item');
        const activeItem = document.querySelector('.dock-item.active');

        // Enhanced bubble movement with elastic easing
        function moveBubbleTo(item) {
            if (!item) return;
            
            const itemRect = item.getBoundingClientRect();
            const dockRect = dock.getBoundingClientRect();
            const left = itemRect.left - dockRect.left;
            const width = itemRect.width;

            // Apply smooth transform with enhanced properties
            bubble.style.left = `${left}px`;
            bubble.style.width = `${width}px`;
            bubble.style.opacity = '1';
            bubble.style.transform = 'scale(1)';
            
            // Add subtle glow effect for active state
            if (item.classList.contains('active')) {
                const isDarkMode = document.body.classList.contains('dark-mode');
                const glowColor = isDarkMode ? 'rgba(10, 132, 255, 0.2)' : 'rgba(0, 113, 227, 0.15)';
                bubble.style.boxShadow = `
                    0 4px 16px rgba(0, 0, 0, 0.1),
                    inset 0 1px 1px rgba(255, 255, 255, 0.3),
                    0 0 20px ${glowColor}
                `;
            } else {
                bubble.style.boxShadow = `
                    0 4px 16px rgba(0, 0, 0, 0.1),
                    inset 0 1px 1px rgba(255, 255, 255, 0.3)
                `;
            }
        }

        // Hide bubble with smooth transition
        function hideBubble() {
            bubble.style.opacity = '0';
            bubble.style.transform = 'scale(0.9)';
        }

        // Set initial position for the bubble on the active item
        if (activeItem) {
            setTimeout(() => {
                moveBubbleTo(activeItem);
            }, 100);
        }

        // Enhanced hover effects with magnetic attraction
        dockItems.forEach((item, index) => {
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶å¤„ç†
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const targetContent = item.getAttribute('data-content');
                switchContent(targetContent);
            });

            item.addEventListener('mouseenter', (e) => {
                moveBubbleTo(item);
                
                // Add magnetic effect to neighboring items
                dockItems.forEach((otherItem, otherIndex) => {
                    const distance = Math.abs(index - otherIndex);
                    if (distance === 1) {
                        // Slight attraction for adjacent items
                        otherItem.style.transform = index > otherIndex 
                            ? 'translateX(2px) scale(1.02)' 
                            : 'translateX(-2px) scale(1.02)';
                    } else if (distance > 1) {
                        // Reset for distant items
                        otherItem.style.transform = '';
                    }
                });
            });

            item.addEventListener('mouseleave', () => {
                // Reset all transforms
                dockItems.forEach(otherItem => {
                    otherItem.style.transform = '';
                });
            });

            // Enhanced click effect
            item.addEventListener('mousedown', () => {
                item.style.transform = 'translateY(1px) scale(0.95)';
                bubble.style.transform = 'scale(0.95)';
            });

            item.addEventListener('mouseup', () => {
                item.style.transform = '';
                bubble.style.transform = 'scale(1)';
            });
        });

        // Improved dock hover behavior
        dock.addEventListener('mouseenter', () => {
            dock.style.transform = 'translateX(-50%) translateY(-2px) scale(1.02)';
        });

        dock.addEventListener('mouseleave', () => {
            dock.style.transform = 'translateX(-50%) translateY(0) scale(1)';
            
            // Return bubble to active item with delay for better UX
            setTimeout(() => {
                const currentActiveItem = document.querySelector('.dock-item.active');
                if (currentActiveItem) {
                    moveBubbleTo(currentActiveItem);
                } else {
                    hideBubble();
                }
                
                // Reset all item transforms
                dockItems.forEach(item => {
                    item.style.transform = '';
                });
            }, 150);
        });

        // Add subtle parallax effect on scroll
        let ticking = false;
        function updateDockParallax() {
            const scrolled = window.pageYOffset;
            const parallax = scrolled * 0.02; // Subtle effect
            
            dock.style.transform = `translateX(-50%) translateY(${parallax}px)`;
            ticking = false;
        }

        function requestTick() {
            if (!ticking) {
                requestAnimationFrame(updateDockParallax);
                ticking = true;
            }
        }

        window.addEventListener('scroll', requestTick);

        // Add touch support for mobile devices
        if ('ontouchstart' in window) {
            dockItems.forEach(item => {
                item.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    moveBubbleTo(item);
                    item.style.transform = 'scale(0.95)';
                });

                item.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    item.style.transform = '';
                    // Simulate click
                    const targetContent = item.getAttribute('data-content');
                    switchContent(targetContent);
                });
            });
        }

        // æœç´¢åŠŸèƒ½ - Search Functionality
        const searchInput = document.getElementById('search-input');
        const searchButton = document.querySelector('.search-button');
        const suggestionTags = document.querySelectorAll('.tag');

        if (searchButton) {
            searchButton.addEventListener('click', () => {
                const query = searchInput.value.trim();
                if (query) {
                    // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€Googleæœç´¢
                    window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
                }
            });
        }

        if (searchInput) {
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchButton.click();
                }
            });
        }

        // æ ‡ç­¾ç‚¹å‡»æœç´¢
        suggestionTags.forEach(tag => {
            tag.addEventListener('click', () => {
                const query = tag.textContent;
                window.open(`https://www.google.com/search?q=${encodeURIComponent(query)}`, '_blank');
            });
        });

        // è®¾ç½®åŠŸèƒ½ - Settings Functionality
        const themeOptions = document.querySelectorAll('.theme-option');

        // ä¸»é¢˜åˆ‡æ¢
        themeOptions.forEach(option => {
            option.addEventListener('click', () => {
                themeOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                
                const theme = option.getAttribute('data-theme');
                if (theme === 'dark') {
                    document.body.classList.add('dark-mode');
                } else if (theme === 'light') {
                    document.body.classList.remove('dark-mode');
                } else {
                    // Auto theme - å¯ä»¥æ ¹æ®ç³»ç»Ÿä¸»é¢˜æˆ–æ—¶é—´æ¥å†³å®š
                    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    if (isDarkMode) {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                }
            });
        });
    </script>
</body>
</html>
